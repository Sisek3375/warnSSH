#!/bin/bash

# Phase de parsing
tail -f -n 0 /var/log/auth.log | while read line; do

  if [[ "$line" == *"sshd"* ]]; then
    
    # DiffÃ©rents cas  
    case "$line" in
        *"Accepted password"*|*"Accepted publickey"*)
	    notify-send "âœ… Connexion SSH rÃ©ussie" "$base_info\nÃ‰tat: Authentification rÃ©ussie"
            ;;
        *"Failed password"*)
            notify-send "âŒ Ã‰chec d'authentification SSH" "$base_info\nÃ‰tat: Mot de passe incorrect" 
            ;;
        *"Invalid user"*)
            notify-send "âš ï¸ Tentative avec utilisateur invalide" "$base_info\nÃ‰tat: Utilisateur inexistant"
            ;;
        *"Connection closed"*|*"Disconnected"*)
            notify-send "ğŸ”Œ DÃ©connexion SSH" "$base_info\nÃ‰tat: Connexion fermÃ©e"
            ;;
        *"Did not receive identification string"*)
            notify-send "ğŸš« Connexion SSH abandonnÃ©e" "$base_info\nÃ‰tat: Identification Ã©chouÃ©e"
            ;;
        *"Connection from"*"closed"*)
            notify-send "ğŸ”’ Connexion SSH fermÃ©e" "$base_info\nÃ‰tat: Connexion interrompue"
            ;;
        *"maximum authentication attempts"*)
            notify-send "ğŸš¨ Trop de tentatives d'authentification" "$base_info\nÃ‰tat: Limite d'essais atteinte"
            ;;
        *"Received disconnect"*)
            notify-send "ğŸ“¡ DÃ©connexion SSH" "$base_info\nÃ‰tat: Client dÃ©connectÃ©"
            ;;
        *"pam_unix(sshd:auth): authentication failure"*)
            notify-send "ğŸ” Ã‰chec d'authentification PAM" "$base_info\nÃ‰tat: Authentification PAM Ã©chouÃ©e"
            ;;
    esac
  fi
done
